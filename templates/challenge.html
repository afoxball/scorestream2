{% extends "base.html" %}
{% block content %}
<div class="content-section">
    <h1>Coding Challenge: {{ title }}</h1>
    <p class="lead">
        <strong>Prompt:</strong> {{ description }}
    </p>
    <hr>
    
    {% if passed %}
        <div class="alert alert-success">
            <h4 class="alert-heading">Well done!</h4>
            <p>You have successfully completed this challenge.</p>
            <hr>
            <p class="mb-0">Would you like to try another question that covers similar concepts but is slightly more complex?</p>
            <div class="mt-3">
                <a href="{{ url_for('home') }}" class="btn btn-secondary">Home</a>
                <a href="{{ url_for('home') }}" class="btn btn-warning">Exit this Session? All work will be saved</a>
                {% if next_challenge_id %}
                    <a href="{{ url_for('challenge', id=next_challenge_id) }}" class="btn btn-danger">Continue with Another</a>
                {% else %}
                    <button class="btn btn-success" disabled>All Challenges Completed!</button>
                {% endif %}
            </div>
        </div>
        
        {% if feedback %}
            <div class="alert alert-info mt-3">
                <h4>Feedback:</h4>
                <ul>
                    {% for msg in feedback %}
                        <li>{{ msg }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

    {% else %}
    
        {% if feedback %}
            <div class="alert alert-warning">
                <h4>Feedback:</h4>
                <ul>
                    {% for msg in feedback %}
                        <li>{{ msg }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        <form method="POST" action="">
            {{ form.hidden_tag() }}
            <fieldset class="form-group">
                <legend class="border-bottom mb-4">Student Info</legend>
                <div class="form-group">
                    {{ form.first_name.label(class="form-control-label") }}
                    {% if form.first_name.errors %}
                        {{ form.first_name(class="form-control is-invalid") }}
                        <div class="invalid-feedback">
                            {% for error in form.first_name.errors %}
                                <span>{{ error }}</span>
                            {% endfor %}
                        </div>
                    {% else %}
                        {{ form.first_name(class="form-control") }}
                    {% endif %}
                </div>
                <div class="form-group">
                    {{ form.last_name.label(class="form-control-label") }}
                    {% if form.last_name.errors %}
                        {{ form.last_name(class="form-control is-invalid") }}
                        <div class="invalid-feedback">
                            {% for error in form.last_name.errors %}
                                <span>{{ error }}</span>
                            {% endfor %}
                        </div>
                    {% else %}
                        {{ form.last_name(class="form-control") }}
                    {% endif %}
                </div>
                <div class="form-group">
                    {{ form.class_period.label(class="form-control-label") }}
                    {% if form.class_period.errors %}
                        {{ form.class_period(class="form-control is-invalid") }}
                        <div class="invalid-feedback">
                            {% for error in form.class_period.errors %}
                                <span>{{ error }}</span>
                            {% endfor %}
                        </div>
                    {% else %}
                        {{ form.class_period(class="form-control") }}
                    {% endif %}
                </div>
                
                <div class="form-group mt-3">
                    {{ form.code_submission.label(class="form-control-label") }}
                    {% if form.code_submission.errors %}
                        {{ form.code_submission(class="form-control is-invalid", rows="10", style="font-family: monospace;") }}
                        <div class="invalid-feedback">
                            {% for error in form.code_submission.errors %}
                                <span>{{ error }}</span>
                            {% endfor %}
                        </div>
                    {% else %}
                        {{ form.code_submission(class="form-control", rows="10", style="font-family: monospace;") }}
                    {% endif %}
                </div>
            </fieldset>
            <div class="form-group mt-3">
                {{ form.submit(class="btn btn-primary") }}
            </div>
        </form>
    {% endif %}
</div>
{% endblock %}
